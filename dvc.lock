schema: '2.0'
stages:
  extract-jhtdb-stats:
    cmd: python -c "import jhtdb; jhtdb.read_stats()"
    deps:
    - path: jhtdb.py
      hash: md5
      md5: bfbdf4db03afdc3d84d0184a411ceb6c
      size: 8489
    outs:
    - path: data/jhtdb-transitional-bl/all-stats.h5
      hash: md5
      md5: 00a5a69441882a30eb8fee49ff13f125
      size: 354031752
  build-paper:
    cmd: latexmk -pdf paper.tex
    deps:
    - path: ../figures/bl-profile-dns.pdf
      hash: md5
      md5: 809bf221005621de7d7ca8bb316e7afc
      size: 9132
    - path: ../figures/time-ave-profiles.pdf
      hash: md5
      md5: d41d8cd98f00b204e9800998ecf8427e
      size: 0
    - path: ../references.bib
      hash: md5
      md5: 2fc1994a416f2c333bb576ad351f0fce
      size: 5856
    - path: paper.tex
      hash: md5
      md5: a4b377ea1048a8ddff704d217e47cee1
      size: 31166
    outs:
    - path: paper.pdf
      hash: md5
      md5: 0eb7b2c002a68a6b0c22651a34338e29
      size: 281725
  run-rans-sim:
    cmd: "mkdir -p sim/results && touch sim/results/time-ave-profile.csv && cd sim
      && make clean-sim && make run-sim\n"
    deps:
    - path: results/coeffs.json
      hash: md5
      md5: 8a80554c91d9fca8acb82f023de02f11
      size: 3
    - path: sim/0
      hash: md5
      md5: c2b10ad61c0733b20c795d37cc45db45.dir
      size: 9800
      nfiles: 7
    - path: sim/Dockerfile.digest
      hash: md5
      md5: 734f1986c2d03a42f08e4374df9db63a
      size: 72
    - path: sim/constant/polyMesh
      hash: md5
      md5: aeae84c06373443c10102ee7122f5a30.dir
      size: 3117895
      nfiles: 5
    - path: sim/constant/transportProperties
      hash: md5
      md5: 81c2cc6d2165efca12be603d7cb1821c
      size: 896
    - path: sim/constant/turbulenceProperties
      hash: md5
      md5: 7456cbf434eb78c0cfa8a3955c6a3501
      size: 1059
    - path: sim/system
      hash: md5
      md5: 0ce2e82fe3ff72e5f614f3643aaa06bb.dir
      size: 11938
      nfiles: 5
    outs:
    - path: sim/100
      hash: md5
      md5: 09305146b8d08d85d89a3a8745818c69.dir
      size: 1407231
      nfiles: 9
    - path: sim/180
      hash: md5
      md5: 73f689fd695db20f395ed423e4165ba3.dir
      size: 1400806
      nfiles: 9
    - path: sim/log.simpleFoam
      hash: md5
      md5: ccc004ea15fad024b74321da701245f0
      size: 140003
    - path: sim/results/time-ave-profile.csv
      hash: md5
      md5: d41d8cd98f00b204e9800998ecf8427e
      size: 0
  plot-time-ave-profiles:
    cmd: mkdir -p figures && touch figures/time-ave-profiles.pdf
    deps:
    - path: data/jhtdb-transitional-bl/time-ave-profiles.h5
      hash: md5
      md5: 46ce259ab949ecb23751eb88ec753ff2
      size: 83344240
    - path: sim/results/time-ave-profile.csv
      hash: md5
      md5: d41d8cd98f00b204e9800998ecf8427e
      size: 0
    outs:
    - path: figures/time-ave-profiles.pdf
      hash: md5
      md5: d41d8cd98f00b204e9800998ecf8427e
      size: 0
  compute-coeffs:
    cmd: mkdir -p results && echo "{}" > results/coeffs.json
    deps:
    - path: data/jhtdb-transitional-bl/all-stats.h5
      hash: md5
      md5: 00a5a69441882a30eb8fee49ff13f125
      size: 354031752
    outs:
    - path: results/coeffs.json
      hash: md5
      md5: 8a80554c91d9fca8acb82f023de02f11
      size: 3
  plot-bl-dns:
    cmd: python scripts/plot-bl-dns.py
    deps:
    - path: data/jhtdb-transitional-bl/all-stats.h5
      hash: md5
      md5: 00a5a69441882a30eb8fee49ff13f125
      size: 354031752
    - path: scripts/plot-bl-dns.py
      hash: md5
      md5: c800d06e86e1169a2a52f8e1643b0704
      size: 407
    outs:
    - path: figures/bl-profile-dns.pdf
      hash: md5
      md5: 809bf221005621de7d7ca8bb316e7afc
      size: 9132
  build-sim-docker:
    cmd: cd sim && make docker
    deps:
    - path: sim/Dockerfile
      hash: md5
      md5: bfc4f904119d4ff511c6976c5008f7fa
      size: 2095
    - path: sim/newModel/src/ransFromDns
      hash: md5
      md5: 618dfcd2d1ebbda9acec8d033ec18931.dir
      size: 14511
      nfiles: 3
    outs:
    - path: sim/Dockerfile.digest
      hash: md5
      md5: 734f1986c2d03a42f08e4374df9db63a
      size: 72
  create-mesh:
    cmd: cd sim && make clean-all && make mesh
    deps:
    - path: sim/Dockerfile.digest
      hash: md5
      md5: 734f1986c2d03a42f08e4374df9db63a
      size: 72
    - path: sim/system/blockMeshDict
      hash: md5
      md5: 975401a4bdc1ddd1af8f31cdb240ae43
      size: 6666
    outs:
    - path: sim/constant/polyMesh
      hash: md5
      md5: aeae84c06373443c10102ee7122f5a30.dir
      size: 3117895
      nfiles: 5
    - path: sim/log.blockMesh
      hash: md5
      md5: ca2d4085f79234f9b2ea12b43f5467c7
      size: 2956
  sample-rans-sim:
    cmd: cd sim && make post-process
    deps:
    - path: sim/180
      hash: md5
      md5: 73f689fd695db20f395ed423e4165ba3.dir
      size: 1400806
      nfiles: 9
    - path: sim/system/sample
      hash: md5
      md5: 07d47fa3e256d22b7e25764e72926d24
      size: 1019
    outs:
    - path: sim/postProcessing
      hash: md5
      md5: 2e8ba4b50af6965b834457ea2a8d546f.dir
      size: 6429
      nfiles: 1
  create-conda-env:
    cmd: "mamba env update && mamba env export -n bl-turb-mod > environment.lock.yml\n"
    deps:
    - path: environment.yml
      hash: md5
      md5: 54eeb7e729e5c86dd97d47f278fbb073
      size: 4576
    outs:
    - path: environment.lock.yml
      hash: md5
      md5: 280be339de9916079e966735a430edfd
      size: 9448
  strip-notebook-outputs:
    cmd: conda run -n bl-turb-mod calkit nb clean notebook.ipynb
    deps:
    - path: notebook.ipynb
      hash: md5
      md5: 6545ee0de057249ba60d532cfcebc656
      size: 165544
    outs:
    - path: .calkit/notebooks/cleaned/notebook.ipynb
      hash: md5
      md5: d226a30e19421d5f2617766019ffa4e3
      size: 16446
  build-notebook:
    cmd: "mkdir -p .calkit/notebooks/html && conda run -n bl-turb-mod jupyter nbconvert
      --execute notebook.ipynb --to html --output .calkit/notebooks/html/notebook.html\n"
    deps:
    - path: .calkit/notebooks/cleaned/notebook.ipynb
      hash: md5
      md5: d226a30e19421d5f2617766019ffa4e3
      size: 16446
    outs:
    - path: .calkit/notebooks/html/notebook.html
      hash: md5
      md5: 4a70a72531917075be0e34f1930d4024
      size: 5293383
  run-notebook:
    cmd: conda run -n bl-turb-mod calkit nb execute --to=html notebook.ipynb
    deps:
    - path: .calkit/notebooks/cleaned/notebook.ipynb
      hash: md5
      md5: d226a30e19421d5f2617766019ffa4e3
      size: 16446
    outs:
    - path: .calkit/notebooks/html/notebook.html
      hash: md5
      md5: a32e0aadcd7d148c9914c0f2901bc44b
      size: 5293383
